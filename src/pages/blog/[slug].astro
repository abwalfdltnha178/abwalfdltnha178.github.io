---
import { getCollection } from "astro:content";
import BlogLayout from "../../layouts/BlogLayout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { entry: post }, // ๐ ุงูุฌุง post ฺฉุงูู ุฑุง ุจู ุนููุงู entry ุจู props ุงุถุงูู ูโฺฉูู
  }));
}

// ๐ ุฏฺฏุฑ ูุงุฒ ุจู ุงู ุฎุทูุท ูุณุช:
// const { slug } = Astro.params;
// const posts = await getCollection("blog");
// const entry = posts.find((post) => post.slug === slug);

// ๐ ุญุงูุง entry ุฑุง ูุณุชููุงู ุงุฒ Astro.props ุฏุฑุงูุช ูโฺฉูู
const { entry } = Astro.props;

// ุจุฑุฑุณ ูุฌูุฏ entry
if (!entry) {
  // ุงู ุญุงูุช ูุจุงุฏ ุงุชูุงู ุจูุชุฏ ุงฺฏุฑ getStaticPaths ุจู ุฏุฑุณุช ฺฉุงุฑ ฺฉูุฏ.
  // ุงูุง ุจุฑุง ุงุทููุงู ูโุชูุงู ุขู ุฑุง ูฺฏู ุฏุงุดุช.
  return { props: { error: true } };
}

// ุญุงูุง frontmatter ุฑุง ุงุฒ entry.data ูโุฎูุงูู
const { Content, data: frontmatter } = await entry.render();

// ุจุฑุง ุงูู ุจุดุชุฑ ุฏุฑ ููุงุด ุชุงุฑุฎ ู ุนููุงู (ฺฉู ูุจูุง ูพุดููุงุฏ ุฏุงุฏู)
const pageTitle = frontmatter.title || "ุนููุงู ูุงูุดุฎุต";
// ุชุงุฑุฎ ุฑุง ุจู ูุฑูุช ูุงุฑุณ ุชุจุฏู ูโฺฉููุ ูุทูุฆู ุดูุฏ ฺฉู frontmatter.date ฺฉ ุฑุดุชู ูุงุจู ุชุจุฏู ุจู ุชุงุฑุฎ ุงุณุช.
const pageDate = frontmatter.date ? new Date(frontmatter.date).toLocaleDateString("fa-IR") : "ุชุงุฑุฎ ูุงูุดุฎุต";
---

<BlogLayout>
  {entry ? ( // ุงู ุดุฑุท ููุดู true ุฎูุงูุฏ ุจูุฏ ุงฺฏุฑ getStaticPaths ุฏุฑุณุช ฺฉุงุฑ ฺฉูุฏ.
    <>
      <h1>{pageTitle}</h1>
      <p><small>{pageDate}</small></p>
      <article><Content /></article>
    </>
  ) : (
    <p>ูพุณุช ุงูุช ูุดุฏ.</p>
  )}
</BlogLayout>
